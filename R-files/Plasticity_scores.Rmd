---
title: "Trait Analysis in Arabidopsis thaliana and Capsella bursa-pastoris"
author: "Bene"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 5
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: 5
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(lme4)
library(emmeans)
```

# Intro

This document serves as both a summary and a working notebook for Project Z2 in CRC 1622. It is intended to clarify and address open questions related to the project, providing a reference point for ongoing discussions and developments. Please note that this file is distinct from the bi-weekly reports submitted to Prof. Dr. Zoran. As a newcomer to the project, you may find this document useful for gaining an overview of past activities as well as understanding the steps planned for the future. The plasticity scores listed here are implemented in separate R files saved in the same directory and on the same branch on github as this file is.


## Experimental Setup

**Species:**  
- *Arabidopsis thaliana*  
- *Capsella bursa-pastoris*

**Growth Conditions:**  
- Different temperature regimes  
- Varying nitrogen levels in the soil

**Measurement Variation:**  
- Five distinct parameter combinations for each condition

## Experimental Treatments and GC-MS Analysis


This section provides an overview of the Gas Chromatography-Mass Spectrometry (GC-MS) analysis pipeline which may be used in the data generation process of Project Z2. GC-MS is employed to examine biochemical changes in response to environmental stresses, such as varying temperatures and nitrogen levels.

example pipeline from [DOI: 10.1111/pce.14146](https://doi.org/10.1111/pce.14146)

1. **Sample Preparation:**  
   - Plant tissues (e.g., leaves, roots) are harvested at specified time points.
   - The tissues are immediately frozen in liquid nitrogen and stored at -80°C until further analysis.
   - For GC-MS, the samples are ground into a fine powder using a mortar and pestle under liquid nitrogen.

2. **Metabolite Extraction:**  
   - The powdered plant material is extracted using a solvent mixture, typically methanol or a combination of methanol and water.
   - The mixture is vortexed and centrifuged to separate the supernatant containing the metabolites.

3. **Derivatization:**  
   - The extracted metabolites are derivatized to make them more volatile and suitable for GC-MS analysis.
   - This often involves the use of derivatizing agents such as N-Methyl-N-(trimethylsilyl)trifluoroacetamide (MSTFA) to convert the metabolites into their trimethylsilyl (TMS) derivatives.

4. **GC-MS Conditions:**  
   - The derivatized samples are injected into a GC-MS system.
   - The GC is equipped with a suitable capillary column (e.g., DB-5MS) and operated under a temperature gradient.
   - The column temperature is gradually increased to separate the metabolites.

5. **MS Detection:**  
   - The separated metabolites are detected using mass spectrometry.
   - The MS detector operates in electron ionization (EI) mode, scanning over a specified mass range to identify the metabolites based on their mass-to-charge (m/z) ratios.

6. **Data Analysis:**  
   - The GC-MS data are analyzed using software to identify and quantify the metabolites.
   - The retention times and mass spectra are compared with reference libraries to confirm the identities of the compounds.
   - The relative abundances of the metabolites are calculated to assess the biochemical changes induced by stress treatments.


## Diversity Panels

Diversity panels are collections of different accessions (genetically distinct lines) used to study genetic diversity, natural variation, and genotype-phenotype associations.

## Reaction Norms of the Trait Data

 A ‘reaction norm’ describes the sensitivity of an organism, or of a set of organisms of the same genotype (e.g., the members of a clone), to some specific environmental variable. It quantifies phenotypic change (or lack of change) in a selected aspect of the phenotype as a function of variation in the environmental factor of interest. The reaction norm approach treats environmental sensitivity as a continuously variable response. 

# Approaches for Quantifying Plasticity

## Nominal Approaches for Quantifying Plasticity

Nominal approaches involve analyzing trait data from a single genotype across various environments. These methods rely on the concept of the reaction norm, which visualizes how trait values of a genotype change across different environments. This approach primarily uses two key concepts:

1. **Slope of the Regression Line**
   - Represents the rate of change in the trait value relative to the environmental variable.
   
2. **Residual Mean Square Error**
   - Quantifies the deviation of actual trait values from the predicted values by the regression line.
   - Suitable when the trait changes linearly with environmental changes.

For traits that do not exhibit linear changes (e.g., enzyme activity with respect to pH), other approaches are required.

### Other Nominal Measures of Plasticity
- **Range**
  - The difference between the maximum and minimum trait values.
  
- **Standard Deviation**
  
- **Coefficient of Variation**
  - The ratio of the standard deviation to the mean, indicating relative variability.
  
- **Stability Index**
  - Quantifies the consistency of trait values across environments.

## Relative Approaches for Quantifying Plasticity
Relative approaches involve analyzing a single trait across multiple genotypes in the same environments. Here are the key points:

1. **Breaking Down Variance**
   - The total variance of a trait is split into parts due to the genotype, the environment, and their interactions. ANOVA helps in determining these components.

2. **Genotype-by-Environment Interaction**
   - This interaction measures how plasticity varies across different genotypes, rather than within a single genotype.

### Example - Finlay and Wilkinson Method

The Finlay-Wilkinson regression is a method used in agronomy and plant breeding to analyze genotype-by-environment interactions (GxE). This technique helps in understanding how different genotypes (e.g., crop varieties) perform across a range of environmental conditions. Finlay-Wilkinson regression is designed to assess the stability and adaptability of different genotypes in varying environments. It aims to identify which genotypes are consistently high-performing across different environments and which ones are more sensitive to environmental changes.




- **Environmental Index**
  - Assumes the interaction between genotype and environment depends on an environmental index.
  
- **Regression Analysis**
  - Trait values for each genotype are compared against the average trait values of all genotypes in each environment.
  
- **Relative Measures**
  - The slope and mean square error from these comparisons provide plasticity measures for each genotype.

```{r}
# Creating a toy dataset
data <- data.frame(
  Environment = rep(1:5, each = 3),
  Genotype = rep(c("G1", "G2", "G3"), times = 5),
  Yield = c(2.5, 3.0, 3.5, 
            2.8, 3.2, 3.6, 
            3.0, 3.4, 3.8,
            3.2, 3.5, 4.0,
            3.5, 3.7, 4.2)
)

# Display the dataset
print(data)

# Calculate environmental means
env_means <- aggregate(Yield ~ Environment, data = data, mean)
colnames(env_means) <- c("Environment", "EnvMean")

# Merge environmental means with original data
data <- merge(data, env_means, by = "Environment")

# Fit regression models for each genotype
fit_G1 <- lm(Yield ~ EnvMean, data = data[data$Genotype == "G1",])
fit_G2 <- lm(Yield ~ EnvMean, data = data[data$Genotype == "G2",])
fit_G3 <- lm(Yield ~ EnvMean, data = data[data$Genotype == "G3",])

# Display summary of each model
summary(fit_G1)
summary(fit_G2)
summary(fit_G3)

# Plotting the results
ggplot(data, aes(x = EnvMean, y = Yield, color = Genotype)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Finlay-Wilkinson Regression Lines",
       x = "Environmental Mean Yield",
       y = "Genotype Yield") +
  theme_minimal()
```

#### Interpretation

* slope close to 1 indicates average stability, meaning the genotype's performance changes proportionally with the environmental factor
* A slope greater than 1 indicates that the genotype is more responsive to environmental improvements (high performance in favorable environments but poor performance in unfavorable ones)
* A slope less than 1 indicates greater stability and lower responsiveness to environmental changes, suggesting the genotype performs relatively consistently across different environments.

# Epigenetics and their influence on plasticity

Plants, being sessile, are constantly exposed to various environmental stresses. To survive and adapt to these conditions, they undergo epigenetic modifications. Epigenomics, the study of large-scale epigenetic marks on the genome, includes changes like histone modifications (acetylation, methylation, phosphorylation, ubiquitination) and small RNA machinery. These modifications play a crucial role in gene expression regulation and phenotypic plasticity under stress.

## Types of Epigenetic Changes in Plants
### Histone Acetylation
Histone acetylation involves the addition of acetyl groups to lysine residues on histone proteins, regulated by histone acetyltransferases (HATs) and histone deacetylases (HDACs). This modification reduces the electrostatic affinity between histones and DNA, allowing transcription. For example, under drought stress, specific HAT genes in wheat are upregulated, contributing to drought resistance.

### DNA Methylation
DNA methylation, the addition of a methyl group to cytosine, is a reversible process that regulates gene expression, growth, and stress responses. For instance, drought conditions lead to increased CG hypermethylation in the pea genome, contributing to stress adaptation.

### Phosphorylation
Histone phosphorylation, particularly of histone H3, plays a role in DNA repair, chromosome condensation, and transcription regulation. Under osmotic stress, phosphorylation of H3T3 in Arabidopsis helps maintain heterochromatin structure and gene repression.

### Ubiquitination
Ubiquitination involves attaching ubiquitin molecules to target proteins, affecting their stability and function. In wheat, the E3 ubiquitin ligase TaPUB1 enhances salt tolerance by upregulating ion channel-related genes.

### Small RNA Machinery
Small RNAs, including miRNAs and siRNAs, play significant roles in stress responses. For example, in Arabidopsis, miRNAs regulate genes involved in proline accumulation, enhancing salt stress tolerance.

## Influence of Different Stresses on the Epigenome
### Drought Stress
Drought induces histone modifications such as H3K4me3 and H3K9ac, which are crucial for the expression of drought-responsive genes like Rd29A and AtGOLS2. DNA methylation changes are also tissue-specific, with roots showing lower methylation levels compared to leaves under drought conditions.

### Salt Stress
Salt stress leads to DNA methylation and demethylation changes, affecting gene expression. In wheat, salt stress results in specific changes in cytosine methylation patterns, while in soybean, it alters the expression of several transcription factors through DNA methylation and histone modifications.

### Heat Stress
Heat stress increases DNA methylation and histone acetylation levels, enhancing the expression of heat-responsive genes. In rice, mild heat stress reduces DNA methylation of the OsFIE1 gene, aiding in stress adaptation.

### Cold Stress
Cold stress induces histone deacetylation and changes in DNA methylation patterns. For example, in Zea mays, cold acclimation results in increased HDAC expression and subsequent deacetylation of histone subunits H3 and H4.

## Conclusion
Epigenetic modifications provide a mechanism for plants to adapt to various abiotic stresses, enhancing their survival and productivity. Understanding these processes can aid in developing crop improvement strategies to ensure sustainable agricultural production in the face of climate change and environmental challenges.


# Summary of Quantitative estimation of phenotypic plastic the gap between the evolutionary concept and applications (Valladares et. al)

This study reviews methods for quantitatively estimating phenotypic plasticity (PP) and applies them to a case study involving four woody species (Quercus robur, Quercus pyrenaica, Pinus sylvestris, and Pinus pinaster) grown under different light conditions. The authors propose new methods for quantifying PP, particularly when traditional indices fall short due to non-linear trait responses. Key results and methods include:

1. **Review of Common Methods**: A detailed review of 17 different plasticity indices used in comparative ecological studies.
2. **Case Study**: Application of these indices to assess growth and shoot-root allocation in seedlings under varying light intensities (1%, 6%, 20%, and 100% full sunlight).
3. **New Indices**: Introduction of the Relative Distance Plasticity Index (RDPI) and the Environmentally Standardized Plasticity Index (ESPI), which allow for statistical comparisons of PP among species.


## Plasticity Scores
The different plasticity scores used in the study are summarized below:

| Estimator                  | Calculation                                             | Source or Examples               | Complexity | Weak Points                                                                                                 |
|----------------------------|---------------------------------------------------------|----------------------------------|------------|-------------------------------------------------------------------------------------------------------------|
| CVt                        | Standard deviation/mean for the whole data set          | Abundant                         | Easy       | Mixes variability within and between environments. Requires normality. Not a proper estimator of plasticity. |
| Slope of norm of reaction  | Slope of regression of trait vs. environment            | Pemac & Tucic (1998)             | Intermediate| Non-linear responses lead to unreliable values. Statistical limitations.                                     |
| D (Scope of plastic response) | Mean at high resource availability - mean at low    | Stearns (1992)                   | Easy       | Not standardized, different traits cannot be compared.                                                      |
| RC (Response Coefficient)  | Ratio of mean values at high and low resource availability | Larcher (1995), Poorter & Nagel (2000) | Easy | Not standardized, different traits cannot be compared.                                                      |
| CVm                        | Standard deviation of means/mean of means               | Schlichting & Levin (1984)       | Easy       | Assumes normality. Statistical limitations.                                                                 |
| CVmd                       | Standard deviation of medians/mean of medians           | Present study                    | Easy       | Statistical limitations.                                                                                    |
| Pi (Grand plasticity)      | Standard deviation of means/mean of adjusted means      | Navas & Garnier (2002)           | Easy       | Assumes normality. Statistical limitations.                                                                 |
| PPF (Phenotypic Plasticity Index, based on least square means) | 100 x ((least square mean in one environment - least square mean in the other)/least square mean in the first environment) | Cheplick (1995) | Intermediate | Assumes normality. Requires adjustment for covariates.                                                     |
| PI (Phenotypic Plasticity Index, based on maximum and minimum means) | (Maximum mean - minimum mean)/maximum mean | Valladares et al. (2000a) | Easy | Assumes normality. Statistical limitations.                                                                 |
| PImd                       | (Maximum median - minimum median)/maximum median        | Present study                    | Easy       | Statistical limitations.                                                                                    |
| PILSM                      | (Maximum least square mean - minimum least square mean)/maximum least square mean | Present study | Intermediate | Assumes normality. Requires adjustment for covariates.                                                     |
| RTR                        | (Mean in one end of environmental gradient - mean in the opposite end)/absolute maximum value | Richardson et al. (2001) | Easy | Assumes normality. Sensitive to outliers. Statistical limitations.                                          |
| PIR                        | (Maximum mean - minimum mean)/mean at which maximum growth rate is achieved | Robinson (1989) | Intermediate | Assumes normality. Requires knowledge of RGR. Statistical limitations.                                       |
| PIN                        | (Σ(Survivali * performancei))/ (n * SD)                 | Milberg et al. (1999)            | Complex    | Assumes normality. Requires knowledge of survival. Statistical limitations.                                  |
| RDPI                       | Absolute phenotypic distances among individuals of same genotype in different environments divided by one of the two phenotypic values | Present study | Intermediate | Complex computing for large data sets.                                                                      |
| RDPIs                      | Absolute phenotypic distances between means of same genotype in different environments divided by one of the two mean phenotypic values | Present study | Intermediate | Not advantageous for small number of environments.                                                          |
| ESPI                       | (Maximum mean - minimum mean)/absolute distance between environmental values | Present study | Easy | Assumes normality. Choice of appropriate environmental range is crucial.                                     |
| ESPIID                     | Absolute phenotypic distances between individuals of same genotype in different environments divided by absolute distance between environmental values | Present study | Complex | Determination of phenotypic distances among individuals is complex and time-consuming.|

a package containing implementations of some of the plasticity scores can be found under:https://github.com/ameztegui/Plasticity/



# Scores/indices to be implemented 

## Polynomial Reaction Norm

### Mathematical Formulation

To express the relationship between a phenotype (\(z(a)\)) and environmental gradient (\(a\)), the reaction norm is modeled as an \(m\)-degree polynomial:
\[
z(a) = b_0 + b_1 \cdot a + b_2 \cdot a^2 + \dots + b_m \cdot a^m
\]
Where:
- \(z(a)\) is the phenotype in environment \(a\),     
- \(b_0\) is the intercept,     
- \(b_1, b_2, \dots, b_m\) are the coefficients representing the amount and pattern of phenotypic change across environments,    
- \(m\) is one fewer than the number of environments.    

### Coefficients as Plasticity Scores

- **Linear plasticity** is captured by the **first-order coefficient** \(b_1\)
- **Non-linear plasticity** is captured by the **higher-order coefficients** \(b_2, b_3, \dots\)
- The **plasticity score** is derived from the magnitude of these coefficients:
  \[
  \text{Plasticity Score} = |b_1| + |b_2| + \dots + |b_m|
  \]
  This score reflects both the magnitude and complexity of the phenotypic response across environments. An obvious problem of this score is that two genotypes can have the same score even if they are different. 

- Another possibility would be applying e.g. max normalization before summing the coefficients of the model. However this still doesn't overcome the problem of possibility of duplicate score even if they're not identical.

### Best Model Selection

- The **best-fitting polynomial model** (linear, quadratic, cubic, etc.) should be determined using statistical criteria such as **goodness-of-fit** or **AIC/BIC**.
- Nonlinear regression is used to estimate the coefficients for each genome.
- Once the best model is selected, the coefficients can be used to calculate the plasticity score for each genotype. 

### Citation

* GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY - Samuel M. Scheiner
* https://www.ugr.es/~jmgreyes/Adaptive%20phenotypic%20plasticity.pdf


## Variance of Polynomial Coefficients

### Mathematical Formulation

When genotypes differ in their **reaction norm functions**, these differences can be captured by the **first and higher-order polynomial coefficients** (\(b_1, b_2, \dots\)). The **genetic variation for plasticity** is represented by the **variance among these coefficients**:
\[
Var(b_i), \quad \text{for } i = 1, 2, \dots, m
\]
This method quantifies genetic variation by capturing how genotypes vary in terms of their **slopes and curvatures** across environments.

### Citation

* GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY - Samuel M. Scheiner

## Cross-environment Correlation/Covariance for Linear Norms

### Mathematical Formulation

For **linear reaction norms** or when there are **only two environments**, genetic variation can also be expressed as the **cross-environment correlation** or **covariance** between traits:
\[
Cov(z_1, z_2)
\]
Where \(z_1\) and \(z_2\) represent the trait values in two different environments. This method captures the **genetic variance for plasticity** by measuring the covariance in trait expressions across environments. For linear norms, the variance is simply related to the slope of the reaction norm.

### Citation

* GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY - Samuel M. Scheiner

## Eigenfunctions of Covariance Matrices (for Nonlinear Norms)

### Mathematical Formulation

For more complex, **nonlinear reaction norms**, a more advanced approach involves using **covariance matrices** and transforming them into **eigenfunctions**:
1. **Covariance matrix** of within-environment genetic variances and cross-environment covariances is generated.
2. **Eigenvectors** are derived from this matrix to describe the pattern of covariance:
   \[
   Cov(z_1, z_2, \dots, z_n) = \lambda_1 \mathbf{v}_1 + \lambda_2 \mathbf{v}_2 + \dots + \lambda_n \mathbf{v}_n
   \]
3. **Legendre polynomials** are used to convert these eigenvectors into continuous **eigenfunctions**:
   \[
   f(x) = \sum_{i=1}^n \lambda_i \cdot P_i(x)
   \]
   where \(P_i(x)\) are the Legendre polynomials. This method can handle **any shaped reaction norm** and is more comprehensive than the covariance method alone.
   
### Citation

* GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY - Samuel M. Scheiner

## Partitioning Phenotypic Variance (for Linear Norms)

### Mathematical Formulation

Another method is based on **variance partitioning** through **analysis of variance** (ANOVA). The **total phenotypic variance** can be divided into:
\[
\sigma^2_{\text{total}} = \sigma^2_g + \sigma^2_{\text{plasticity}}
\]
Where:
- \(\sigma^2_g\) is the genetic variance independent of the environment,
- \(\sigma^2_{\text{plasticity}}\) is the variance due to plastic effects (dependent on the environment).

For **linear reaction norms**, this method provides a simple measure of genetic variation for plasticity by partitioning the total variance.

### Citation

* GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY - Samuel M. Scheiner

## Genetic Variation for Plasticity in Linear Norms

### Mathematical Formulation

For **linear reaction norms**, Gavrilets & Scheiner (Adaptive phenotypic plasticity) provide an estimation of genetic variation for plasticity:
\[
\sigma^2_{\text{plasticity}} = g_1^2 \cdot Var(a)
\]
Where:
- \(g_1\) is the mean slope of the reaction norms across all genotypes,
- \(Var(a)\) is the variance of the environmental gradient.

For **genetic variation for slopes**:
\[
\sigma^2_{\text{plasticity}} = G_1 \cdot Var(a)
\]
Where \(G_1\) is the genetic variation for the slopes, representing the **genetic variation for plasticity**.


## Genetic Variance and Heritability in Plasticity

from:GENETICS AND EVOLUTION OF PHENOTYPIC PLASTICITY (Samuel M. Scheiner)

### Overview

Genetic variance is a key component in understanding how traits vary due to genetics and how these traits respond to selection. In the context of phenotypic plasticity, genetic variance explains how much of the variation in the plastic response (i.e., changes in traits across different environments) is due to genetic differences.

#### 1. Estimating Genetic Variance

The total phenotypic variance (\(\sigma^2_p\)) can be split into genetic variance (\(G\)) and environmental variance (\(E\)):

\[
\sigma^2_p = G + E
\]

Where:
- \(G\) represents the **genetic variance**, which accounts for differences between genotypes.
- \(E\) represents the **environmental variance**, which captures variation due to environmental differences.

Genetic variance is often estimated using experimental designs such as **full-sibling** or **half-sibling** designs. By comparing individuals with known relationships, it is possible to partition phenotypic variance into genetic and environmental components.

#### 2. Genetic Variance in Phenotypic Plasticity

For phenotypic plasticity, genetic variance is calculated by measuring how trait expression changes across environments (reaction norm). The **slope of the reaction norm** can be used to estimate the genetic variance for plasticity:

\[
G_1 = \text{Variance of the slope of the reaction norm across environments}
\]

This means that the genetic variance for plasticity depends on how much the slope (or shape) of the trait’s change across environments differs between genotypes.

#### 3. Heritability of Plasticity

Heritability in the context of plasticity refers to the proportion of phenotypic variation in plasticity that is due to genetic factors. Heritability measures are particularly important when making predictions about how a population might respond to selection.

### Heritability: Descriptive and Predictive Measures

#### 3.1 Descriptive Measures of Genetic Variation

When the goal is to understand the relative amounts of genetic variation that are dependent or independent of the environment, heritability is averaged across environments. Two key heritability measures exist for this purpose:

- **\( h_m^2 \)**: The heritability of the **environmentally independent portion** of the trait (mean trait value across environments).
- **\( h_{\pi}^2 \)**: The heritability of the **environmentally dependent portion** (plasticity).

These are calculated as follows:

\[
h_m^2 = \frac{G_0}{\sigma_p^2}, \quad h_{\pi}^2 = \frac{G_1}{\sigma_p^2}
\]

Where:
- \( G_0 \) is the genetic variance for the **mean trait** value across environments (environmentally independent portion).
- \( G_1 \) is the genetic variance for the **plasticity** (environmentally dependent portion).
- \( \sigma_p^2 \) is the total phenotypic variation across all environments.

These measures provide insight into the amount of genetic variation that influences traits and plasticity, helping to compare different traits, studies, and species on a scale-free metric.

#### 3.2 Predictive Measures for Plasticity Under Selection

When predicting the **response to selection on plasticity**, a different heritability measure is used. In this case, the heritability is often measured in the context of **family selection** on a plasticity index.

For family selection on plasticity, the heritability is calculated as:

\[
h_{\text{plasticity}}^2 = \frac{\sigma_f^2}{\sigma_p^2}
\]

Where:
- \( \sigma_f^2 \) is the genetic variation among families for the plasticity index.
- \( \sigma_p^2 \) is the total phenotypic variation for the plasticity index.

If the study involves only two environments, the plasticity index typically measures the **difference in family means** between environments. To obtain accurate heritability values, the total phenotypic variation must be corrected for errors in estimating family means.



## Multivariate Vector of Plasticity

The **Multivariate Vector of Plasticity** evaluates the distance moved by each trait between different environmental conditions. This multivariate approach considers multiple traits and calculates the Euclidean (or other) distance between the trait values in different environments.

### Mathematical Approach

The vector of plasticity for a given trait can be computed using the formula:

\[
\text{Vector of Plasticity} = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2 + \cdots}
\]

Where:
- \(x_1, y_1, \ldots\) are the trait values in the first environment, and
- \(x_2, y_2, \ldots\) are the corresponding trait values in the second environment.

This formula calculates the Euclidean distance, representing the overall change in trait values across environments.

### Citation

https://royalsocietypublishing.org/doi/10.1098/rspb.2015.1651

## θplast: Angle Between Vectors of Plasticity

**θplast** is a measure of the direction of plasticity between different environments. It is calculated as the angle between the plasticity vectors of two environments using the dot product formula. This angle helps determine whether traits respond in similar or different directions under different environmental conditions.

### Formula

\[
\cos(\theta_{\text{plast}}) = \frac{\mathbf{v}_1 \cdot \mathbf{v}_2}{\|\mathbf{v}_1\|\|\mathbf{v}_2\|}
\]

Where:
- \(\mathbf{v}_1\) and \(\mathbf{v}_2\) are the vectors of plasticity for two different environments.
- \(\|\mathbf{v}_1\|\) and \(\|\mathbf{v}_2\|\) are the magnitudes of the vectors.
- The angle \(\theta_{\text{plast}}\) provides insight into the degree of similarity or divergence in trait plasticity between environments.

### Citation

https://royalsocietypublishing.org/doi/10.1098/rspb.2015.1651



## Plasticity Coefficient (PC)

### Mathematical Formulation

The **Plasticity Coefficient (PC)** is a simple measure of phenotypic plasticity, calculated as the relative change between the maximum and minimum trait values across environments, normalized by the average trait value.

\[
PC = \frac{\text{Maximum Trait Value} - \text{Minimum Trait Value}}{\text{Average Trait Value}}
\]

Where:
- **Maximum Trait Value**: The highest observed trait value across environments.
- **Minimum Trait Value**: The lowest observed trait value across environments.
- **Average Trait Value**: The mean of the trait values across environments.

### Citation

This method is conceptually similar to the **Phenotypic Plasticity Index (PI)** by Valladares et al. (2000). However this score uses the maximum and minimum mean trait values, normalized by the maximum mean trait value to quantify plasticity.

- Valladares, F., Wright, S.J., Lasso, E., Kitajima, K., & Pearcy, R.W. (2000). *Plastic phenotypic responses to light of 16 congeneric shrubs from a Panamanian rainforest*. Ecology, 81(7), 1925-1936.



## Shannon’s Diversity Index for Phenotypic Plasticity

Shannon’s Diversity Index (H') can be adapted to measure phenotypic plasticity by quantifying the diversity of phenotypic traits across different environments. Two distinct approaches are commonly used: **within-environment diversity** and **across-environment diversity**.

In the **within-environment method**, Shannon’s Diversity Index is calculated separately for each environment using the formula:

\[
H' = - \sum_{i} p_i \log(p_i)
\]

where \( p_i \) is the proportion of individuals exhibiting phenotype \( i \) in a given environment. This method highlights the phenotypic diversity within each environment, allowing for a comparison of how diversity changes across environmental conditions.

In the **across-environment method**, the proportion of each phenotype is summed across all environments, and a single Shannon’s Diversity Index is calculated using the same formula:

\[
H' = - \sum_{i} p_i \log(p_i)
\]

where \( p_i \) now represents the proportion of individuals exhibiting phenotype \( i \) across all environments combined. This approach provides a measure of overall phenotypic plasticity, reflecting the diversity of trait expression across environments collectively.

### Citations

- Shannon, C. E. (1948). "A Mathematical Theory of Communication." *Bell System Technical Journal*, 27, 379-423.
- Magurran, A. E. (1988). *Ecological Diversity and Its Measurement*. Princeton University Press.
- Richards, C. L., Bossdorf, O., & Pigliucci, M. (2010). "What role does heritable epigenetic variation play in phenotypic evolution?" *BioScience*, 60(3), 232-237.


### Mahalanobis Distance

**Description:**  
Mahalanobis distance, introduced by Mahalanobis (1936), is a multivariate distance metric that measures how far a data point (in this case, a vector of trait values) is from the mean of a distribution, accounting for the covariance between traits. It is useful for identifying phenotypic plasticity across environments by evaluating how the trait values of an individual environment deviate from the overall mean trait values across multiple environments. This method is particularly effective when dealing with correlated traits.

**Formula:**
$$
D^2 = (\mathbf{x} - \mathbf{m})^T \mathbf{S}^{-1} (\mathbf{x} - \mathbf{m})
$$

Where:
- \(\mathbf{x}\) is the vector of trait values for an environment, containing all measured traits for that specific environment.
- \(\mathbf{m}\) is the mean trait vector, which represents the average trait values across all environments.
- \(\mathbf{S}\) is the covariance matrix, which captures the covariation between the different traits.

### Interpretation:

- \(D^2\) is the squared Mahalanobis distance. A larger value indicates that the traits in a particular environment differ more from the overall mean traits across environments, potentially suggesting greater phenotypic plasticity.
- The Mahalanobis distance accounts for the correlation between traits, making it more robust in cases where traits are not independent.
- This distance can be used to compare how different environments affect the expression of multiple traits simultaneously.

**Reference:**
- Mahalanobis, P. C. (1936). "On the generalized distance in statistics." Proceedings of the National Institute of Sciences of India, 2(1), 49-55.


## Variance Partitioning (VP)

### Formula
\[
VP = \frac{\sigma^2_{\text{plasticity}}}{\sigma^2_{\text{total}}}
\]
Where:
- \(\sigma^2_{\text{plasticity}}\) is the variance due to plasticity.
- \(\sigma^2_{\text{total}}\) is the total phenotypic variance.

### Description

Variance partitioning is a common statistical technique (Falconer & Mackay, 1996) that quantifies the proportion of total phenotypic variance attributable to environmental plasticity. It helps in understanding the genetic and environmental contributions to trait variation.

### Citation

- Falconer, D. S., & Mackay, T. F. (1996). *Introduction to quantitative genetics* (4th ed.). Longman.

## Mean Trait Difference (MTD)

### Formula

\[
MTD = \frac{\sum (z_{\text{env1}} - z_{\text{env2}})}{n}
\]
Where:
- \(z_{\text{env1}}\) and \(z_{\text{env2}}\) are trait values in two environments.
- \(n\) is the number of individuals.

### Description

Mean Trait Difference (MTD) is a straightforward measure of phenotypic plasticity that calculates the average difference in trait values between two environments. It has been applied in various ecological studies to assess phenotypic change (Schlichting & Pigliucci, 1998).

### Citation
- Schlichting, C. D., & Pigliucci, M. (1998). *Phenotypic evolution: A reaction norm perspective*. Sinauer Associates.


## Diathesis-Stress Model

this yet again is not a plasticity score but a model for prediction purposes. This is listed here because it has caught my interest. 

The **Diathesis-Stress Model** is a widely used framework for explaining how **predisposition** (diathesis) interacts with **environmental stressors** to influence outcomes. Originally applied in psychological research, this model is also applicable in studying **plasticity** in plants or other organisms. In this context, **diathesis** represents the genetic or physiological vulnerability of an organism, while **stress** refers to external environmental factors (e.g., drought, nutrient deficiency). The interaction between these factors determines the observed outcome, such as plant growth or health.

The Diathesis-Stress Model can be mathematically expressed as a **linear regression model** with interaction terms. The basic form of the model is:

\[
y = \beta_0 + \beta_1 \cdot x_1 + \beta_2 \cdot x_2 + \beta_3 \cdot (x_1 \cdot x_2) + \epsilon
\]

Where:
- \( y \): The **outcome variable**, such as plant growth or health.
- \( x_1 \): The measure of **diathesis** or **genetic vulnerability**, which could be a score representing predisposition to stress.
- \( x_2 \): The measure of **stress** (e.g., drought intensity or nutrient availability).
- \( \beta_0 \): The **intercept**, representing the baseline level of the outcome when both diathesis and stress are zero.
- \( \beta_1 \): The **coefficient** for diathesis, representing the effect of genetic vulnerability on the outcome, holding stress constant.
- \( \beta_2 \): The **coefficient** for stress, representing the effect of environmental stress on the outcome, holding diathesis constant.
- \( \beta_3 \): The **interaction term**, representing how the effect of stress on the outcome changes depending on the level of genetic vulnerability (and vice versa).
- \( \epsilon \): The **error term**, accounting for variance not explained by the model.


- **Diathesis (\( x_1 \))**: This term represents an organism’s **predisposition** to stress, which could be genetic or physiological in nature. In plants, this could be a drought sensitivity index or a genetic score that indicates vulnerability.
  
- **Stress (\( x_2 \))**: This term represents an **external environmental factor** that acts as a stressor, such as drought, temperature, or nutrient deficiency. The level of stress can vary and is usually measured continuously or categorically (e.g., high or low drought).

- **Interaction (\( x_1 \cdot x_2 \))**: The interaction term is key to the Diathesis-Stress Model, as it explains how the effect of stress on the outcome is **modulated** by the level of diathesis. For example, plants with a high genetic predisposition to drought sensitivity may experience more significant growth reduction under drought stress than plants with lower sensitivity.


- **\( \beta_0 \)**: The baseline outcome when both diathesis and stress are zero. For example, it represents the expected plant growth when there is no genetic vulnerability or stress.

- **\( \beta_1 \)**: This coefficient tells us how much the outcome changes for a one-unit increase in **genetic vulnerability** (\( x_1 \)), assuming that stress remains constant.

- **\( \beta_2 \)**: This coefficient tells us how much the outcome changes for a one-unit increase in **stress** (\( x_2 \)), assuming that genetic vulnerability remains constant.

- **\( \beta_3 \)**: The interaction coefficient indicates how the effect of **stress** on the outcome is **dependent** on the level of diathesis. A significant \( \beta_3 \) suggests that the impact of stress on growth is different for plants with varying levels of genetic vulnerability.


The Diathesis-Stress Model makes several assumptions typical of linear regression:
1. **Linearity**: The relationship between the independent variables (diathesis and stress) and the dependent variable (outcome) is linear, including their interaction.
2. **Independence**: The observations are independent of each other.
3. **Homoscedasticity**: The variance of the error terms is constant across levels of the independent variables.
4. **Normality of Residuals**: The residuals (errors) are normally distributed.

### Use Cases in Plant Studies

In plant studies, the Diathesis-Stress Model is particularly useful for exploring how different genotypes (vulnerabilities) interact with environmental conditions (stressors) to affect outcomes like growth, yield, or survival. For example:
- **Genetic Vulnerability (\( x_1 \))**: This could be quantified based on genetic markers or physiological traits that predict sensitivity to drought.
- **Stress (\( x_2 \))**: This could be measured as the severity of drought or nutrient deficiency in different environments.

By fitting this model, researchers can assess whether plants with different genetic backgrounds respond differently to environmental stressors, and how these responses influence key outcomes.

### References
- Zubin, J., & Spring, B. (1977). "Vulnerability: A new view of schizophrenia." *Journal of Abnormal Psychology*, 86(2), 103-126.
- Monroe, S. M., & Simons, A. D. (1991). "Diathesis-stress theories in the context of life stress research: Implications for the depressive disorders." *Psychological Bulletin*, 110(3), 406-425.





## Random Regression Mixed Modeling (RRMM)


this is not a score and wont be implemented but it caught my interest and therefor I wanted to include it here. 

**Random Regression Mixed Modeling (RRMM)** is a flexible statistical approach used to model **longitudinal data** or **repeated measures** data where the response variable is measured over time or across different conditions. It is commonly applied in fields like **animal and plant breeding**, **genetics**, and **environmental sciences** to capture the variation in individual trajectories while accounting for both **fixed effects** (common to the population) and **random effects** (specific to individuals or groups).

### Key Components

The general form of a random regression mixed model is:

\[
y_{ij} = X_{ij} \beta + Z_{ij} u_j + \epsilon_{ij}
\]

Where:
- **\( y_{ij} \)**: The observed response for individual \( j \) at time (or condition) \( i \).
- **\( X_{ij} \beta \)**: The **fixed effects** that apply to the entire population, such as the overall effect of time or environmental conditions.
- **\( Z_{ij} u_j \)**: The **random effects** that account for individual-specific trajectories or responses, where the intercepts and slopes may vary across individuals.
- **\( \epsilon_{ij} \)**: The residual error term, representing variability not captured by the model.


**Random regression** allows the slope and intercept of the regression line to vary randomly across individuals. This flexibility makes it possible to model how each individual’s response evolves over time or environmental gradients, with individual-specific deviations from the population-level trend.

The typical random regression mixed model includes both **random intercepts** (initial differences between individuals) and **random slopes** (individual-specific rates of change), and can be written as:

\[
y_{ij} = \beta_0 + \beta_1 \cdot t_i + u_{0j} + u_{1j} \cdot t_i + \epsilon_{ij}
\]

Where:
- **\( \beta_0 \)**: Fixed intercept, representing the population average at baseline.
- **\( \beta_1 \)**: Fixed slope, representing the average rate of change in the population.
- **\( u_{0j} \)**: Random intercept for individual \( j \), capturing the individual-specific deviation from the population average.
- **\( u_{1j} \cdot t_i \)**: Random slope for individual \( j \), allowing the rate of change to vary for each individual.
- **\( \epsilon_{ij} \)**: Residual error for the \( i \)-th measurement of individual \( j \).


### Interpretation of Parameters

1. **Fixed Effects** (\( \beta_0, \beta_1 \)): These represent the average population-level effects. For instance, \( \beta_1 \) is the population's average rate of change in the outcome (e.g., growth) over time or environmental gradients.

2. **Random Effects** (\( u_{0j}, u_{1j} \)): These capture the individual-specific variations:
   - **Random intercepts** represent how each individual differs from the average starting value.
   - **Random slopes** represent how the rate of change for each individual deviates from the average.

3. **Covariance Structure**: RRMM also models the covariance between random intercepts and random slopes, allowing researchers to see if individuals with higher initial values also experience different rates of change.

### Model Assumptions

- **Linearity**: The relationship between the covariates (e.g., time, environment) and the response variable is linear.
- **Random Effects**: The random effects (slopes and intercepts) are assumed to follow a normal distribution.
- **Independence**: Observations from different individuals or groups are independent.
- **Homoscedasticity**: The residuals (errors) are assumed to have constant variance.

### References

- Schaeffer, L. R. (2004). "Application of random regression models in animal breeding." *Livestock Production Science*, 86(1), 35-45.
- Meyer, K. (1998). "Estimating covariance functions for longitudinal data using a random regression model." *Genetics Selection Evolution*, 30(3), 221-240.
- Henderson, C. R. (1982). "Analysis of covariance in the mixed model: Higher level, nonhomogeneous, and random regressions." *Biometrics*, 38(3), 623-640.
- Meyer, K. (2001). "Estimation of genetic covariance functions." *Livestock Production Science*, 69(2), 95-113.


## Relative Plasticity Index (RPI)

**Description:** RPI quantifies the relative change in a trait between two environments.

**Formula:**
$$
RPI = \frac{|Trait Value_{Env1} - Trait Value_{Env2}|}{Trait Value_{Env1} + Trait Value_{Env2}}
$$



**Reference:** Valladares, F., & Niinemets, Ü. (2008). Shade Tolerance, a Key Plant Feature of Complex Nature and Consequences. *Annual Review of Ecology, Evolution, and Systematics*, 39(1), 237-257.

## Plasticity Quotient (PQ)

**Description:** PQ measures the ratio of trait change to the environmental change.

**Formula:**
$$
PQ = \frac{\Delta Trait Value}{\Delta Environmental Change}
$$



**Reference:** Scheiner, S. M. (1993). Genetics and Evolution of Phenotypic Plasticity. *Annual Review of Ecology and Systematics*, 24(1), 35-68.

## Plasticity Differential (PD)

**Description:** PD calculates the absolute difference in trait values between control and stress conditions.

**Formula:**
$$
PD = |Trait Value_{Stress} - Trait Value_{Control}|
$$



**Reference:** DeWitt, T. J., & Scheiner, S. M. (Eds.). (2004). *Phenotypic Plasticity: Functional and Conceptual Approaches*. Oxford University Press.

## Norm of Reaction Width (NRW)

**Description:** NRW measures the total range of trait values across different environments.

**Formula:**
$$
NRW = Max Trait Value_{Env} - Min Trait Value_{Env}
$$



**Reference:** Stearns, S. C. (1992). *The Evolution of Life Histories*. Oxford University Press.

## Phenotypic Range (PR)

**Description:** PR quantifies the range of trait values, capturing the maximum variation between environments.

**Formula:**
$$
PR = Max Trait Value - Min Trait Value
$$



**Reference:** Valladares, F., Wright, S. J., Lasso, E., Kitajima, K., & Pearcy, R. W. (2000). Plastic phenotypic responses to light of 16 congeneric shrubs from a Panamanian rainforest. *Ecology*, 81(7), 1925-1936.

## Environment-Specific Plasticity (ESP)

**Description:** ESP measures the trait plasticity for a particular environment relative to the mean across all environments.

**Formula:**
$$
ESP_{Env} = \frac{Trait Value_{Env} - Mean Trait Value_{All Envs}}{Mean Trait Value_{All Envs}}
$$



**Reference:** Scheiner, S. M. (1993). Genetics and Evolution of Phenotypic Plasticity. *Annual Review of Ecology and Systematics*, 24(1), 35-68.

## Fitness Plasticity Index (FPI)

**Description:** FPI quantifies how fitness-related traits, like survival or biomass, change across environments.

**Formula:**
$$
FPI = \frac{Fitness_{Stress} - Fitness_{Control}}{Fitness_{Control}}
$$



**Reference:** Nicotra, A. B., Atkin, O. K., Bonser, S. P., Davidson, A. M., Finnegan, E. J., Mathesius, U., ... & van Kleunen, M. (2010). Plant phenotypic plasticity in a changing climate. *Trends in Plant Science*, 15(12), 684-692.


## Transplant Plasticity Score (TPS)

**Description:** TPS measures the plasticity of a trait when an organism is transplanted to a different environment.

**Formula:**
$$
TPS = \frac{(Trait Value_{Transplanted Env} - Trait Value_{Native Env})}{Trait Value_{Native Env}}
$$



**Reference:** Dudley, S. A., & Schmitt, J. (1995). Genetic differentiation in morphological responses to simulated foliage shade between populations of *Impatiens capensis* from open and woodland sites. *Functional Ecology*, 9(4), 655-666.

##  Developmental Plasticity Index (DPI)

this also cannot be considered a real plasticity score as it is bound to time resolved data only. 

**Description:** DPI quantifies plasticity during development by measuring how traits change over time or developmental stages.

**Formula:**
$$
DPI = \frac{(Trait Value at Time 2 - Trait Value at Time 1)}{Time Interval}
$$



**Reference:** West-Eberhard, M. J. (2003). *Developmental Plasticity and Evolution*. Oxford University Press.

## Coefficient of Environmental Variation (CEV)

**Description:** CEV measures the coefficient of variation of trait values across different environments, providing an indication of trait variability.

**Formula:**
$$
CEV = \frac{\text{Standard Deviation of Trait Values Across Environments}}{\text{Mean Trait Value Across Environments}} \times 100
$$



**Reference:** Schlichting, C. D. (1986). The evolution of phenotypic plasticity in plants. *Annual Review of Ecology and Systematics*, 17, 667-693.

---

## Plasticity Response Index (PRI)

**Description:** PRI calculates plasticity as the proportional difference in trait values between extreme environments (e.g., best vs. worst condition) divided by the average trait value across environments.

**Formula:**
$$
PRI = \frac{\text{Trait Value in Extreme Environment} - \text{Trait Value in Control Environment}}{\text{Mean Trait Value Across All Environments}}
$$



**Reference:** Valladares, F., & Niinemets, Ü. (2008). Shade tolerance, a key plant feature of complex nature and consequences. *Annual Review of Ecology, Evolution, and Systematics*, 39(1), 237-257.

---



## Phenotypic Flexibility Index (PFI)

**Description:** PFI measures the degree of flexibility in trait values over time or environments, particularly useful for reversible plasticity.

**Formula:**
$$
PFI = \frac{|\text{Maximum Deviation From Baseline}|}{\text{Baseline Trait Value}}
$$



**Reference:** DeWitt, T. J., Sih, A., & Wilson, D. S. (1998). Costs and limits of phenotypic plasticity. *Trends in Ecology & Evolution*, 13(2), 77-81.

---

## Standardized Plasticity Index (SPI)

**Description:** SPI standardizes trait plasticity by comparing trait values across environments relative to a reference trait or genotype.

**Formula:**
$$
SPI = \frac{(\text{Trait Value}_{Env2} - \text{Trait Value}_{Env1})}{\text{Standard Deviation of Reference Trait Values}}
$$



**Reference:** Scheiner, S. M. (1993). Genetics and evolution of phenotypic plasticity. *Annual Review of Ecology and Systematics*, 24(1), 35-68.

---


## Absolute Plasticity Coefficient (APC)

**Description:** APC quantifies absolute plasticity by calculating the average absolute difference in trait values between environments.

**Formula:**
$$
APC = \frac{1}{n-1} \sum_{i=1}^{n-1} |\text{Trait Value}_{Env_{i+1}} - \text{Trait Value}_{Env_i}|
$$



**Reference:** Nicotra, A. B., Atkin, O. K., Bonser, S. P., Davidson, A. M., Finnegan, E. J., Mathesius, U., et al. (2010). Plant phenotypic plasticity in a changing climate. *Trends in Plant Science*, 15(12), 684-692.

---

## Stability Index

The **Stability Index** quantifies the stability of a trait across environments, measuring how consistent a genotype's trait expression is in varying conditions.

### Formula

\[
\text{Stability Index (SI)} = \frac{\text{Variance across environments}}{\text{Mean trait value across environments}}
\]

Where:
- **Variance across environments**: The variability of trait values across different environments.
- **Mean trait value across environments**: The average trait value across environments.

### Reference

- Finlay, K. W., & Wilkinson, G. N. (1963). The analysis of adaptation in a plant-breeding programme. *Australian Journal of Agricultural Research*, 14(6), 742-754.

---

## Relative Stability Index (RSI)

**Description:** RSI measures the relative stability of a trait across environments, focusing on trait stability despite environmental fluctuations.

**Formula:**
$$
RSI = 1 - \frac{\text{Standard Deviation of Trait Values Across Environments}}{\text{Mean Trait Value Across Environments}}
$$



**Reference:** Finlay, K. W., & Wilkinson, G. N. (1963). The analysis of adaptation in a plant-breeding programme. *Australian Journal of Agricultural Research*, 14(6), 742-754.

---

## Environmental Variance Sensitivity (EVS)

**Description:** EVS captures how sensitive a trait is to changes in environmental variance.

**Formula:**
$$
EVS = \frac{\Delta \text{Trait Variance}}{\Delta \text{Environmental Variance}}
$$


**Reference:** Schlichting, C. D., & Pigliucci, M. (1998). *Phenotypic Evolution: A Reaction Norm Perspective*. Sinauer Associates.

---

## Plasticity Stability Ratio (PSR)

**Description:** PSR combines plasticity and stability by measuring the ratio between plasticity and stability across environments.

**Formula:**
$$
PSR = \frac{\text{Plasticity Score}}{\text{Stability Score}}
$$


**Reference:** Lande, R. (1982). A quantitative genetic theory of life history evolution. *Ecology*, 63(3), 607-615.


## Multivariate Plasticity Index (MVPi)

**Description**:  
The Multivariate Plasticity Index (MVPi) is a multiscale and integrative plasticity index based on ordination methods like Canonical Variate Analysis (CVA). It condenses multiple phenotypic traits into a single index, representing the overall phenotypic state of a genotype in a given environment. MVPi quantifies plasticity as the Euclidean distance between phenotypic states across environments, offering a comprehensive and standardized way to compare plastic responses between species or genotypes.

### Canonical Variate Analysis (CVA) and its Role:

Canonical Variate Analysis (CVA) is a multivariate statistical method that transforms high-dimensional phenotypic data (many traits) into a set of new orthogonal axes (canonical variates), which are ranked based on how well they separate predefined groups (such as different environments or genotypes). Each genotype or environment is assigned a set of scores (CV1, CV2, CV3, etc.) on these axes. The MVPi uses these scores to calculate the Euclidean distances between phenotypic states in different environments.

### Note to CVA

At the first glimps PCA and CVA seem like closely related mutivariat methods which can be used interchangeably. However this perception is not correct. Here a clarification:

PCA is a very widespread multivariate method and it is useful whenever the data matrix is composed by a set of independent subjects, for which we have recorded a number of variables and we are only interested in the differences between those independent subjects. In contrast to this, data from experiments with replicates are not composed by independent subjects, but there are groups of subjects treated alike. PCA is not the right tool in this case, because it looks at the distance between individuals, but we are more concerned about the distance between groups of individuals, which is a totally different concept. Canonical Variate Analysis (CVA) is much better suited to the purpose of group discrimination.

from:https://www.statforbiology.com/2023/stat_multivar_cva/

### Mathematical Formulation:

The MVPi uses the Euclidean distances (ED) between phenotypic states represented by their Cartesian projections on the dimensions of a Canonical Variate Analysis (CVA). The number of dimensions \(k\) in the CVA is equal to the number of quantitative phenotypic parameters evaluated. The coordinates of an individual \( i \) and a quantitative phenotypic parameter \( k \) on the s-axis are given by the following equations:

\[
I_s(i) = \frac{1}{\sqrt{\lambda_s}} \sum_{k} x_{ik} m_k QP_s(k)
\]

\[
QP_s(k) = \frac{1}{\sqrt{\lambda_s}} \sum_{i} x_{ik} p_i I_s(i)
\]

Where:
- \( I_s(i) \) is the coordinate of individual \( i \) on the s-axis.               
- \( QP_s(k) \) is the coordinate of the quantitative phenotypic parameter \( k \) on the s-axis.               
- \( \lambda_s \) is the eigenvalue associated with the s-axis.               
- \( x_{ik} \) is the matrix element representing the phenotypic value of individual \( i \) for parameter \( k \).               
- \( m_k \) is the weight associated with parameter \( k \), and \( p_i \) is the weight related to individual \( i \).               

### Euclidean Distance Calculation:  

The phenotypic plasticity is measured as the Euclidean distance between two phenotypic states (e.g., environment \( A \) and environment \( B \)) in the multidimensional space defined by the CVA. The Euclidean distance between two environments (A and B) with coordinates \( (CV1, CV2, \dots, CVk) \) is computed as:

\[
\text{ED}_{AB} = \sqrt{\sum_{i=1}^{k} (CV_{Ai} - CV_{Bi})^2}
\]

Where:
- \( CV_{Ai} \) and \( CV_{Bi} \) are the scores of environments \( A \) and \( B \) on the \( i \)-th canonical variate axis.

Finally, the MVPi is estimated as the average distance across all combinations of phenotypic states between replicates in environments \( A \) and \( B \):

\[
\text{MVPi} = \frac{\sum (\text{ED}_{1-1} + \cdots + \text{ED}_{1-m} + \cdots + \text{ED}_{n-1} + \text{ED}_{n-m})}{n \cdot m}
\]

Where:
- \( ED \) represents the Euclidean distance between phenotypic states in environments \( A \) and \( B \).      
- \( n \) and \( m \) are the number of replicates in environments \( A \) and \( B \), respectively.      

               
### Reference

A systemic approach to the quantification of the phenotypic plasticity of plant physiological traits: the multivariate plasticity index (https://doi.org/10.1093/jxb/eraa545)


## Standardized Plasticity Metric (SPM)

**Description:** The standardized plasticity metric (SPM) quantifies phenotypic plasticity by comparing trait values between resident and nonresident environments. The metric ranges from 0 to infinity, where values near 0 indicate low or no plasticity, and larger values indicate increasing levels of plasticity.

**Formula:**
$$
\text{SPM} = \frac{| \text{AinA} - \text{AinB} |}{\text{AinA}} \quad \text{or} \quad \frac{| \text{BinB} - \text{BinA} |}{\text{BinB}}
$$

Where:
- \( \text{AinA} \) and \( \text{BinB} \): Trait values in the resident environment.
- \( \text{AinB} \) and \( \text{BinA} \): Trait values in the nonresident environment.


**Reference:** The ubiquity of phenotypic plasticity in plants: a synthesis, https://doi.org/10.1002/ece3.1603

## SSpop/SStotal Plasticity Ratio

**Description:**  
This plasticity score quantifies the relative contribution of population differences to overall phenotypic variability across different environments. It is calculated as the ratio of the sum of squares between populations (\(SSpop\)) to the total sum of squares (\(SStotal\)) from a one-way ANOVA. This ratio can be interpreted as a measure of phenotypic divergence and plasticity at the population level.

### Formula:
\[
\text{Plasticity Ratio} = \frac{SS_{pop}}{SS_{total}}
\]
Where:
- **\(SS_{pop}\)**: The sum of squares due to population differences (between-population variability).
- **\(SS_{total}\)**: The total sum of squares (total phenotypic variability) across populations and environments.

This ratio ranges from 0 to 1:
- A value close to **0** indicates low plasticity or minimal variation between populations.
- A value closer to **1** suggests that most phenotypic variability is driven by population differences, indicating higher plasticity.


### Reference:
Invasion strategies in clonal aquatic plants: are phenotypic differences caused by phenotypic plasticity or local adaptation? https://doi.org/10.1093/aob/mcq176


## Multivariate Trait Integration and Plasticity Approach

**Description:**  
This approach combines the use of Principal Component Analysis (PCA) to reduce the dimensionality of phenotypic data and Generalized Linear Mixed Models (GLMM) to analyze the effect of genotypes and environmental interactions on phenotypic traits. It provides a multivariate way of exploring how traits integrate and respond to environmental conditions across different genotypes.

### Steps:

1. **Principal Component Analysis (PCA)**:
   - **Goal**: To reduce the dimensionality of the dataset by transforming the original data into a smaller set of uncorrelated variables (principal components).
   - **Method**: The dataset is transformed, and only principal components with eigenvalues greater than 1 are retained for further analysis.
   - **Formula**:
     \[
     PC_k = \sum_{i=1}^{n} a_i X_i
     \]
     Where:
     - \(PC_k\) is the \(k\)-th principal component.
     - \(a_i\) is the weight (loading) assigned to the \(i\)-th trait (variable) in the data.
     - \(X_i\) is the standardized value of the \(i\)-th trait.
   - **Interpretation**: Principal components are linear combinations of the original variables, and factor loadings with an absolute value greater than 0.4 are considered biologically relevant.

2. **Generalized Linear Mixed Models (GLMM)**:
   - **Goal**: To examine the effects of genotype, environment (e.g., light and water treatments), and their interactions on the principal component scores.
   - **Model**: The GLMMs include both fixed and random effects. The genotype is treated as a random effect, while environmental conditions (light, water) are fixed effects.
   - **Formula**:
     \[
     Y = \mu + G + E_W + E_L + G \times E_W + G \times E_L + E_W \times E_L + G \times E_W \times E_L + \epsilon
     \]
     Where:
     - \(Y\) is the principal component score.
     - \(\mu\) is the overall mean.
     - \(G\) represents the random effect of genotype.
     - \(E_W\) and \(E_L\) are the fixed effects of water and light environments.
     - \(G \times E_W\), \(G \times E_L\), and \(G \times E_W \times E_L\) represent the interaction terms.
     - \(\epsilon\) is the residual error.


### Reference

The plasticity of phenotypic integration in response to light and water availability in the pepper grass, Lepidium bonariense,

## Two-State Multivariate Vector Plasticity Approach

**Description:**  
This method compares phenotypic responses across environments using multivariate reaction norms for different populations. Phenotypic plasticity is quantified based on the magnitude and direction of multivariate vectors, representing the change in trait values across environments. The approach is designed to compare how populations respond to environmental changes by analyzing both the amount and direction of trait covariation.

### Mathematical Formulation:

1. **Reaction Norm Vector (ΔX):**  
   The multivariate reaction norm for a population is calculated as the difference between the phenotypic trait means in two environments (i and j):
   \[
   \Delta X = \bar{X}_i - \bar{X}_j
   \]
   Where:
   - \(\bar{X}_i\) and \(\bar{X}_j\) are vectors of mean trait values in environment \(i\) and \(j\), respectively.

2. **Magnitude of Phenotypic Change (D):**  
   The Euclidean distance of a population’s reaction norm vector, representing the magnitude of phenotypic change, is calculated as:
   \[
   D = \sqrt{\Delta X^\top \Delta X}
   \]
   Where:
   - \(\Delta X^\top\) is the transpose of \(\Delta X\).

3. **Direction of Phenotypic Change (θ):**  
   The similarity in orientation between the reaction norm vectors of two populations (denoted 1 and 2) is described by the angle between the vectors. First, the vector correlation (VC) is calculated:
   \[
   VC_{1,2} = \frac{\Delta X_1^\top \Delta X_2}{|\Delta X_1||\Delta X_2|}
   \]
   Then, the angle between the vectors is calculated as:
   \[
   \theta_{1,2} = \cos^{-1}(VC_{1,2})
   \]
   Small angles (\(\theta_{1,2} \rightarrow 0\)) indicate similar orientations between the vectors.

### Application:  
This approach was applied to compare the phenotypic plasticity of native and invasive populations of *purple loosestrife* in four environments with varying water and nutrient levels. The multivariate reaction norm was used to analyze both the magnitude and direction of phenotypic change across environments for life history traits.

**Reference:**  
PHENOTYPIC PLASTICITY OF NATIVE VS. INVASIVE PURPLE LOOSESTRIFE: A TWO-STATE MULTIVARIATE APPROACH, https://doi.org/10.1890/06-0856



## Multivariate Phenotypic Plasticity (Collyer & Adams 2007)

**Description:**
Multivariate phenotypic plasticity is measured by calculating the magnitude and direction of phenotypic change vectors in a multivariate trait space. This method involves performing a PCA on population trait means from different environments and calculating vectors that represent the phenotypic change between those environments. The magnitude of the vector reflects the **quantitative difference** in trait values between environments, while the direction of the vector indicates the **covariation of traits** across environments.

**Formula:**
1. **PCA for Phenotypic Space:**
   - Perform a PCA on the scaled and centered population trait means across environments (e.g., well-watered and dry).
   - Compute the **phenotypic change vector** for each population.
   
2. **Vector Magnitude:**
   \[
   \text{Magnitude (Length)} = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2 + \dots}
   \]
   Where \(x_1, y_1, \dots\) are trait values in one environment, and \(x_2, y_2, \dots\) are the corresponding values in another environment.

3. **Vector Direction (Angle):**
   The direction of the vector can be described as the angle (\(\theta\)) of the phenotypic change vector in multivariate space.

   \[
   \theta = \arccos\left(\frac{\mathbf{v}_1 \cdot \mathbf{v}_2}{|\mathbf{v}_1||\mathbf{v}_2|}\right)
   \]
   Where:
   - \(\mathbf{v}_1\) and \(\mathbf{v}_2\) are vectors representing phenotypic traits across environments.

**Interpretation:**
- **Vector Magnitude** reflects the overall phenotypic change between environments, quantifying the extent of plasticity.
- **Vector Direction** indicates which traits are most involved in the phenotypic response and how trait covariation differs across environments.



**Reference:**  
Collyer, M. L., & Adams, D. C. (2007). Phenotypic trajectory analysis: comparison of shape change patterns in evolution and ecology. *Hystrix*, 18(1), 75-90.
Multi-trait genetic variation in resource-use strategies and phenotypic plasticity correlates with local climate across the range of a Mediterranean oak (Quercus faginea), https://doi.org/10.1111/nph.17968



## Phenotypic Dissimilarity Index (PDI)

**Description**: The Phenotypic Dissimilarity Index (PDI) captures the overall phenotypic variation between two environments, generalized across multiple traits. It measures the relative deviation in trait values between environments.

**Formula**:
\[
PDI = \frac{1}{n} \sum_{i=1}^{n} \left| \frac{T_{Env1_i} - T_{Env2_i}}{T_{Env1_i} + T_{Env2_i}} \right|
\]
Where \(T_{Env1_i}\) and \(T_{Env2_i}\) represent trait values in environments 1 and 2, and \(n\) is the number of traits.

**Reference**:  
- Valladares, F., & Niinemets, Ü. (2008). Shade tolerance, a key plant feature of complex nature and consequences. *Annual Review of Ecology, Evolution, and Systematics*, 39(1), 237-257.

---

## Plasticity Residual Variance (PRV)

**Description**: PRV measures the residual variance in trait values after accounting for the main environmental effect. It evaluates how much variation remains unexplained, reflecting unmodeled plastic responses.

**Formula**:
\[
PRV = \frac{\sum (T_{observed} - T_{predicted})^2}{n}
\]
Where \(T_{observed}\) is the observed trait value in each environment and \(T_{predicted}\) is the expected trait value based on environmental means.

**Reference**:  
- Lande, R. (1982). A quantitative genetic theory of life history evolution. *Ecology*, 63(3), 607-615.

---

## Adaptability Index (AI)

**Description**: The Adaptability Index reflects a genotype's ability to maintain performance across a range of environments.

**Formula**:
\[
AI = \frac{\text{Mean Trait Value in Favorable Environments}}{\text{Mean Trait Value Across All Environments}}
\]

**Reference**:  
- Nicotra, A. B., et al. (2010). Plant phenotypic plasticity in a changing climate. *Trends in Plant Science*, 15(12), 684-692.

---

## Response Variability Coefficient (RVC)

**Description**: RVC captures the variability in trait responses across environments relative to the mean trait value.

**Formula**:
\[
RVC = \frac{\sigma_T}{\mu_T}
\]
Where \(\sigma_T\) is the standard deviation of trait values across environments, and \(\mu_T\) is the mean trait value.

**Reference**:  
- Scheiner, S. M. (1993). Genetics and evolution of phenotypic plasticity. *Annual Review of Ecology and Systematics*, 24(1), 35-68.

---

## Performance Stability Ratio (PSR)

**Description**: PSR assesses the balance between plasticity and stability by calculating the ratio of plasticity to stability.

**Formula**:
\[
PSR = \frac{\text{Plasticity Coefficient}}{\text{Stability Index}}
\]

**Reference**:  
- Falconer, D. S., & Mackay, T. F. (1996). *Introduction to quantitative genetics* (4th ed.). Longman#.

---

### Genetic Variation for Plasticity Score (GVPS)

The Genetic Variation for Plasticity Score (GVPS) quantifies genetic plasticity by calculating the variance in the reaction norm coefficients across genotypes. When performing a linear regression of a trait across \(m\) environments, each genotype generates \(m - 1\) coefficients due to the regression fit. The GVPS is computed by taking the variance of these coefficients across different genotypes, providing a measure of genetic variability in plastic responses.

**Formula**:
For a set of \( n \) genotypes, and the coefficients \( \beta_1, \beta_2, ..., \beta_{m-1} \) obtained from regression across \( m \) environments, the GVPS is calculated as:

\[
GVPS = \text{Var}(\beta_1, \beta_2, ..., \beta_{m-1})
\]

where \(\text{Var}\) denotes the variance across genotypes for the coefficients estimated from their respective reaction norms.

**Reference**:

- Gavrilets, S., & Scheiner, S. M. (1993). "The genetics of phenotypic plasticity." *Journal of Evolutionary Biology*, 6, 31-48.



## Genetic Variance for Plasticity (Two Environments)

Genetic variance for plasticity can be measured when reaction norms are linear or when only two environments are considered. This measure evaluates how consistently different genotypes respond to environmental changes by calculating the **across-environment correlation** or **covariance** between trait values across environments.

The formula for calculating genetic variance in plasticity using covariance is:

\[
\text{Cov}_{gen}(TraitValue_{Env1}, TraitValue_{Env2}) = \frac{\sum (x_{i1} - \bar{x}_1)(x_{i2} - \bar{x}_2)}{n}
\]

Where \(x_{i1}\) and \(x_{i2}\) are trait values for individual \(i\) in Environment 1 and Environment 2, and \(\bar{x}_1\) and \(\bar{x}_2\) are the mean trait values in each environment.


## Statistical methods

NPMANOVA



## Categorization of Plasticity Scores

### Nominal Approaches
Nominal approaches quantify plasticity for a single genotype across multiple environments, often using reaction norms and measures of statistical dispersion.

| **Category**                        | **Scores**                                                                 |
|-------------------------------------|----------------------------------------------------------------------------|
| **Reaction Norms & Slope-Based**    | Reaction Norm Slope (RNS), Polynomial Reaction Norm, Coefficients of Polynomial Reaction Norm, Variance of Polynomial Coefficients, |
| **Statistical Dispersion**          | Coefficient of Variation (CV), Phenotypic Range (PR), Norm of Reaction Width (NRW), Maximum-Minimum Plasticity Index (MMPI), Absolute Plasticity Coefficient (APC), Stability Index, Shannon Entropy, SSpop/SStotal Plasticity Ratio, Mahalanobis Distance, Variance Partitioning (VP) |

---

### Relative Approaches
Relative approaches analyze a trait across multiple genotypes and environments, often using modifications of ANOVA and regression-based methods to quantify plasticity.

| **Category**                        | **Scores**                                                                 |
|-------------------------------------|----------------------------------------------------------------------------|
| **Regression & Slope-Based**        | Finlay-Wilkinson Regression, Relative Plasticity Index (RPI), Plasticity Quotient (PQ), Environment-Specific Plasticity (ESP), Sensitivity Index (SI), Transplant Plasticity Score (TPS), Standardized Plasticity Index (SPI), Plasticity Coefficient (PC), Plasticity Differential (PD), Reaction Norm Slope, Mean Trait Difference (MTD) |
| **ANOVA-Based & Variance Measures** | Cross-environment Correlation/Covariance, Variance of Polynomial Coefficients, Partitioning Phenotypic Variance, Environmental Variance Sensitivity (EVS), Random Regression Mixed Modeling (RRMM), Plasticity Stability Ratio (PSR) |

---

### Quantitative Genetics Approaches
Quantitative genetics approaches focus on identifying genetic loci that control plasticity, typically using variance-based and advanced statistical models.

| **Category**                        | **Scores**                                                                 |
|-------------------------------------|----------------------------------------------------------------------------|
| **Variance-Based & Genetic Models** | Genetic Variation for Plasticity in Linear Norms, Polynomial Reaction Norm, Eigenfunctions of Covariance Matrices, Random Regression Mixed Modeling (RRMM), Relative Stability Index (RSI), Plasticity Stability Ratio (PSR), Phenotypic Flexibility Index (PFI), Developmental Plasticity Index (DPI), Heritability of Plasticity, Genetic Variance in Plasticity, Multivariate Vector of Plasticity, θplast (Angle Between Plasticity Vectors), Multivariate Trait Integration and Plasticity Approach, Two-State Multivariate Vector Plasticity Approach |





Publications scraped 10.09.24:

* A systemic approach to the quantification of the phenotypic plasticity of plant physiological traits: the multivariate plasticity index
* Relatedness predicts phenotypic plasticity in plants better than weediness
* The ubiquity of phenotypic plasticity in plants: a synthesis
* A modular concept of phenotypic plasticity in plants
* Plasticity genes and plasticity costs: a new approach using an Arabidopsis recombinant inbred population
* Invasion strategies in clonal aquatic plants: are phenotypic differences caused by phenotypic plasticity or local adaptation?
* Quantification of plasticity of plant traits in response to light intensity: comparing phenotypes at a common weight
* Phenotypic Plasticity Index as a Strategy for Selecting Water-Stress-Adapted Coffee Genotypes
* Plant phenotypic plasticity belowground: a phylogenetic perspective on root foraging trade-offs
* Phenotypic plasticity in response to environmental heterogeneity contributes to fluctuating asymmetry in plants: first empirical evidence
* Adaptive plasticity and epigenetic variation in response to warming in an Alpine plant
* Trait convergence and plasticity among native and invasive species in resource-poor environments
* Linking the spatial scale of environmental variation and the evolution of phenotypic plasticity: selection favors adaptive plasticity in fine-grained environments
* Dynamic phenotypic plasticity for root growth in Polygonum: a comparative study
* The role of phenotypic plasticity and rapid adaptation in determining invasion success of Plantago virginica
* Leaf phenotypic plasticity coupled with integration facilitates the adaptation of plants to enhanced N deposition
* The plasticity of phenotypic integration in response to light and water availability in the pepper grass, Lepidium bonariense
* Intraspecific trait variation and phenotypic plasticity mediate alpine plant species response to climate change
* Phenotypic plasticity of native vs. invasive purple loosestrife: a two-state multivariate approach
* Variability in growth and biomass allocation and the phenotypic plasticity of seven Prosopis pallida populations in response to water availability
* Phenotypic Diversity and Altered Environmental Plasticity in Arabidopsis thaliana with Reduced Hsp90 Levels
* Testing the adaptive plasticity hypothesis: density-dependent selection on manipulated stem length in Impatiens capensis
* Genomic architecture of phenotypic plasticity in response to water stress in tetraploid wheat
* Epigenetic correlates of plant phenotypic plasticity: DNA methylation differs between prickly and nonprickly leaves in heterophyllous Ilex aquifolium (Aquifoliaceae)
* Different genotypes of Phragmites australis show distinct phenotypic plasticity in response to nutrient availability and temperature
* Multi-trait genetic variation in resource-use strategies and phenotypic plasticity correlates with local climate across the range of a Mediterranean oak (Quercus)
* Phenotypic plasticity of vegetative and reproductive traits in monoecious and dioecious populations of Sagittaria latifolia (Alismataceae): a clonal aquatic plant
* Phenotypic plasticity to light and nutrient availability alters functional trait ranking across eight perennial grassland species
* A conceptual framework for the analysis of phenotypic plasticity and genetic constraints in plants
* How does long-term drought acclimation modify structure-function relationships? A quantitative approach to leaf phenotypic plasticity of barley

Publications scraped 12.09.24:

* Plant stress responses and phenotypic plasticity in the epigenomics era: perspectives on the grapevine scenario, a model for perennial crop plants
* Flood induced phenotypic plasticity in amphibious genus Elatine (Elatinaceae)


#########################################################

# New Beginnings 



## 1. Dataset Structure and Sample Details

- **Objective**: Create synthetic datasets representing trait variability across controlled environmental gradients, enabling robust analysis of reaction norms and plasticity scores.

### Dataset Composition

- **Genotypes**: Two genotypes to analyze genotype-by-environment (GxE) interactions.
- **Traits**: Three traits per genotype, representing different biological functions (e.g., growth rate, defense response, physiological adaptation).
- **Environmental Conditions**: Five distinct environmental levels per genotype, arranged along a gradient (e.g., low to high light, temperature, or moisture) to capture optimal to stress-inducing responses.
- **Replicates**: Six samples per genotype-environment combination, reflecting realistic biological variability.

- **Sample Calculation**:
  - Total samples per genotype: \(3 \text{ traits} \times 5 \text{ environmental conditions} \times 6 \text{ replicates} = 90 \text{ samples per genotype}\)
  - Total samples for the study: \(2 \text{ genotypes} \times 90 = 180 \text{ samples}\)

## 2. Reaction Norm Types and Experimental Setup

- **Purpose**: Establish structured reaction norms for each trait-environment combination to enable controlled comparison of plasticity scores.

### Reaction Norm Categories

- **Linear Norms**: Consistent positive, negative, or zero slopes (environmentally insensitive).
- **Nonlinear Norms**: Quadratic (curved) norms, with peaks or troughs at intermediate environments.
- **Sigmoidal Norms**: S-shaped responses, with gradual adaptation to extremes and steeper middle responses.
- **Threshold-based Norms**: Traits change abruptly after an environmental threshold, simulating a rapid stress response.

### Reaction Norm Combinations

- **Linear vs. Linear (non-crossing)**: Genotypes show similar responses without interaction.
- **Linear vs. Linear (crossing)**: Interaction points where genotypes differ across the gradient.
- **Linear vs. Nonlinear**: Mixed norms (e.g., linear vs. quadratic) with or without crossing points, for complex GxE interactions.

## 3. Plasticity Score Calculation

- **Objective**: Quantify trait variability across environments using a set of plasticity scores.

### Scores to be Calculated

- **Included Scores**: `CV_t`, `RNS`, `D_slope`, `RC`, `CVm`, `Pi`, `RTR`, `PSI`, `APC`, `RSI`, among others.
- **Calculation Process**: Each score is computed across traits, genotypes, and environments, yielding a comprehensive data matrix for clustering analysis.

## 4. Clustering and Analytical Methods

### Clustering Analysis

- **Methods**: Hierarchical clustering, Partitioning Around Medoids (PAM), and DBSCAN for score pattern analysis.
- **Conditions**: Conduct clustering across the full environmental gradient and separately for environmental extremes.

### Trait Grouping and Functional Analysis

- **Grouping**: Organize traits by functional type (e.g., growth, defense, physiology) to examine if scores capture plasticity within these categories.
- **Gene Types**: If available, associate scores with gene-related traits to observe clustering across gene functions.

## 5. Regression and Correlation Analysis for Fitness Prediction

- **Purpose**: Identify correlations between scores and fitness indicators under stress conditions.

### Approach

- **Regression Models**: Use linear regression to correlate plasticity scores (individually and by cluster) with fitness measures.
- **Fitness Measures**: Define fitness based on relevant traits under stress, such as yield under drought, to assess if score patterns predict adaptability.

## 6. Validation in a Natural Setting

- **Application**: Evaluate if specific plasticity scores, clustering patterns, or high values indicate stress or developmental stages in natural settings.
- **Example**: Apply scores to assess forest health by determining if score patterns correlate with stress or developmental stages, aiding forest management and conservation.

## Main Objective

To develop a deeper understanding of phenotypic plasticity by identifying which plasticity scores capture underlying adaptive mechanisms, predict fitness, and reveal environmental responses in plants. This study will assess if certain scores can signal stress, developmental stages, or specific genotype-environment (GxE) interactions, thereby refining how plasticity is measured and applied.

---

### Guiding Questions and Approach

#### 1. Can certain plasticity scores reveal underlying adaptive mechanisms in traits?

- **Goal**: Determine if specific scores capture inherent biological processes, such as adaptability or resilience, beyond simple trait quantification.
- **Approach**: Use structured reaction norms across two genotypes under controlled environmental gradients. By analyzing clustering patterns of scores across different reaction norm types (e.g., linear, non-linear, threshold-based), identify which scores consistently signal adaptive traits in response to changing conditions.

#### 2. How can score clustering inform the selection of functionally relevant traits?

- **Goal**: Examine if plasticity scores cluster in ways that correspond to biological function groups (e.g., growth, defense).
- **Approach**: Cluster plasticity scores for traits related to known biological functions and assess consistency in clustering patterns. Determine if specific scores align with particular trait groups, suggesting that certain scores may inherently capture key aspects of those functions, offering a means to choose function-specific scores.

#### 3. Do high values of specific scores or clustering patterns indicate stress or developmental stages?

- **Goal**: Investigate whether plasticity scores can act as indicators of plant health, signaling stress responses or particular stages of development.
- **Approach**: Identify plasticity scores that show distinct clustering or high values in response to environmental stress or developmental cues. Test if these scores could be used to monitor plant health in natural settings, such as assessing tree health in a forest, by correlating score patterns with stress conditions or age-related traits.

#### 4. Is it necessary to measure plasticity across the full environmental spectrum, or can extremes provide similar insights?

- **Goal**: Determine whether sampling at environmental extremes suffices to capture the essence of phenotypic plasticity.
- **Approach**: Compare clustering results from datasets that cover full environmental gradients with those focused on extreme conditions. Assess if extreme-based measurements yield clustering patterns comparable to full-spectrum data, suggesting a more streamlined approach for future studies on environmental adaptation.

#### 5. Are specific plasticity scores predictive of fitness under stressful conditions?

- **Goal**: Identify if certain scores correlate with higher fitness levels, particularly under stressful environmental conditions, implying a practical value for predicting adaptability.
- **Approach**: Calculate fitness measures (e.g., yield, growth rate) alongside plasticity scores under controlled stress conditions (e.g., drought, nutrient limitation). Use regression or correlation analysis to determine if score clusters or high values are associated with fitness, highlighting scores as indicators of adaptive potential.

#### 6. Do certain scores or patterns indicate adaptive trade-offs between traits?

- **Goal**: Explore if score clustering reveals inherent trade-offs in resource allocation among traits, with high plasticity in one trait potentially linked to lower plasticity in another.
- **Approach**: Analyze correlations among plasticity scores across multiple traits within each genotype. Look for patterns where higher plasticity in one trait coincides with lower plasticity in others, suggesting trade-offs and balanced adaptation strategies under limited resources.

#### 7. Do polygenic traits display more complex, non-linear reaction norms and clustering patterns compared to simpler traits?

- **Goal**: Assess if the complexity of a trait’s genetic basis (polygenic vs. monogenic) influences its plasticity score clustering, with polygenic traits potentially displaying intricate adaptation patterns.
- **Approach**: Compare clustering patterns of plasticity scores for polygenic versus monogenic traits. Examine if polygenic traits exhibit more complex, non-linear clustering, indicating that genetic complexity drives richer patterns of trait plasticity and adaptability.

#### 8. Can plasticity scores identify adaptive windows for key traits in specific environments?

- **Goal**: Discover if plasticity scores cluster around specific environmental extremes, suggesting adaptive windows where traits express peak plasticity crucial for survival.
- **Approach**: Identify score patterns that consistently cluster at certain environmental thresholds, such as high or low light, temperature, or moisture. Analyze if these windows correlate with heightened plasticity, revealing adaptive flexibility points for traits in critical conditions.
